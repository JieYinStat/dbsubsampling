---
title: "IES_Simulation"
output:
  html_document:
    df_print: paged
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r library_package, message=FALSE}
library(dbsubsampling)
library(bench)
library(gam)
library(tidyr)
library(dplyr)
library(ggplot2)
library(purrr)
library(parallel)
```

# Test the compilation environment.

Since this brochure is built from a github remote server, let's first test the setup of the server. I'll write a small snippet of code here to check if it works on the github remote server. Mainly because `mclapply` doesn't run on windows, in addition to testing to see if parallel computation is possible and estimating the running time.

- Nonparallel:

```{r nonparallel}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- lapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1])
print(Sys.time() -  start_time)
```

- Parallel with 2 cores:

```{r parallel_2}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- mclapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1], mc.cores = 2)
print(Sys.time() -  start_time)
```

- Parallel with 3 cores:

```{r parallel_3}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- mclapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1], mc.cores = 3)
print(Sys.time() -  start_time)
```

- Parallel with 4 cores:

```{r parallel_4}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- mclapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1], mc.cores = 4)
print(Sys.time() -  start_time)
```

- Parallel with 5 cores:

```{r parallel_5}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- mclapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1], mc.cores = 5)
print(Sys.time() -  start_time)
```

- Parallel with 8 cores:

```{r parallel_8}
data <- data_IES_Case_1_Train
start_time <- Sys.time()
result <- mclapply(1:50000, function(x) lm(y ~. , data = data)[["coefficients"]][1], mc.cores = 8)
print(Sys.time() -  start_time)
```

